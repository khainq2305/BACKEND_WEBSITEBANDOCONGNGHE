require('dotenv').config();
const { PostSEO } = require('./src/models');

async function createPostSEOTable() {
  try {
    console.log('Äang táº¡o báº£ng post_seo...');
    
    // Táº¡o báº£ng náº¿u chÆ°a tá»“n táº¡i
    await PostSEO.sync({ force: false });
    
    console.log('âœ… Báº£ng post_seo Ä‘Ã£ Ä‘Æ°á»£c táº¡o thÃ nh cÃ´ng!');
    
    // Táº¡o má»™t sá»‘ dá»¯ liá»‡u máº«u (tÃ¹y chá»n)
    const sampleData = {
      postId: 1, // Giáº£ sá»­ cÃ³ post vá»›i ID = 1
      seoTitle: 'TiÃªu Ä‘á» SEO máº«u - Tá»‘i Æ°u cho tÃ¬m kiáº¿m',
      metaDescription: 'MÃ´ táº£ meta máº«u cho bÃ i viáº¿t, tá»‘i Æ°u SEO vá»›i Ä‘á»™ dÃ i phÃ¹ há»£p tá»« 120-160 kÃ½ tá»± Ä‘á»ƒ hiá»ƒn thá»‹ tá»‘t trÃªn káº¿t quáº£ tÃ¬m kiáº¿m.',
      focusKeywords: ['SEO', 'tá»‘i Æ°u tÃ¬m kiáº¿m', 'marketing'],
      canonicalUrl: 'https://yoursite.com/sample-post',
      ogTitle: 'TiÃªu Ä‘á» Open Graph',
      ogDescription: 'MÃ´ táº£ Open Graph cho máº¡ng xÃ£ há»™i',
      ogImage: 'https://yoursite.com/images/og-image.jpg',
      twitterTitle: 'TiÃªu Ä‘á» Twitter Card',
      twitterDescription: 'MÃ´ táº£ Twitter Card',
      twitterImage: 'https://yoursite.com/images/twitter-image.jpg',
      seoScore: 85,
      autoGenerateTitle: true,
      autoGenerateDescription: true
    };
    
    // Kiá»ƒm tra xem Ä‘Ã£ cÃ³ dá»¯ liá»‡u máº«u chÆ°a
    const existingSample = await PostSEO.findOne({ where: { postId: 1 } });
    if (!existingSample) {
      console.log('Äang táº¡o dá»¯ liá»‡u máº«u...');
      await PostSEO.create(sampleData);
      console.log('âœ… Dá»¯ liá»‡u máº«u Ä‘Ã£ Ä‘Æ°á»£c táº¡o!');
    } else {
      console.log('â„¹ï¸ Dá»¯ liá»‡u máº«u Ä‘Ã£ tá»“n táº¡i');
    }
    
    console.log('\nğŸ‰ Thiáº¿t láº­p PostSEO hoÃ n táº¥t!');
    console.log('\nCÃ¡c API endpoint cÃ³ sáºµn:');
    console.log('- GET /admin/post-seo/posts - Láº¥y danh sÃ¡ch posts vá»›i SEO');
    console.log('- GET /admin/post-seo/posts/:postId - Láº¥y thÃ´ng tin SEO cá»§a post');
    console.log('- PUT /admin/post-seo/posts/:postId - Cáº­p nháº­t SEO cá»§a post');
    console.log('- POST /admin/post-seo/posts/:postId/analyze - PhÃ¢n tÃ­ch SEO');
    console.log('- GET /admin/post-seo/stats - Thá»‘ng kÃª SEO');
    
  } catch (error) {
    console.error('âŒ Lá»—i khi táº¡o báº£ng post_seo:', error);
  } finally {
    process.exit();
  }
}

createPostSEOTable();
